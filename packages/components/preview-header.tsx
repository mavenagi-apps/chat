"use client";

import { Button } from "@/packages/ui/src/button";
import { cn } from "@/packages/ui/src/lib/utils";
import { CheckIcon, LinkIcon } from "@heroicons/react/24/outline";
import { useCallback, useEffect, useState } from "react";

interface PreviewHeaderProps {
  badgeText?: string;
}

export function PreviewHeader({ badgeText = "Preview" }: PreviewHeaderProps) {
  const [isCopied, setIsCopied] = useState(false);
  const [currentUrl, setCurrentUrl] = useState("");

  useEffect(() => {
    setCurrentUrl(window.location.href);
  }, []);

  const handleCopyLink = useCallback(async () => {
    try {
      await navigator.clipboard.writeText(currentUrl);
      setIsCopied(true);

      setTimeout(() => setIsCopied(false), 2000);
    } catch (err) {
      console.error("Failed to copy link:", err);
    }
  }, [currentUrl]);

  return (
    <header className="sticky top-0 z-50 w-full bg-white/95 backdrop-blur supports-[backdrop-filter]:bg-white/60">
      <div className="h-12 mx-auto max-w-[1344px]">
        <div className="h-full px-3 py-1.5 bg-[#f7f5f2] rounded-lg border border-[#efece8] backdrop-blur-[10px] flex items-center justify-between overflow-hidden">
          <div className="flex items-center gap-4 pl-1.5">
            <div data-svg-wrapper className="relative">
              {/* Maven Logo SVG */}
              <svg
                width="99"
                height="18"
                viewBox="0 0 99 18"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <g clipPath="url(#clip0_2920_60608)">
                  <path
                    d="M34.8217 0.574707H33.0619L29.633 12.7495L26.2408 0.574707H24.0683H23.0689H21.1791V17.2334H24.0683V4.074L27.8263 17.2334H28.37H30.7377H31.0637L34.8217 3.95343V17.2334H37.9932V0.574707H35.7777H34.8217Z"
                    fill="#732EB8"
                  />
                  <path
                    d="M47.439 5.12883C46.7071 4.78794 45.7555 4.61816 44.5819 4.61816C43.5101 4.61816 42.5801 4.80346 41.7906 5.17316C41.0007 5.54374 40.3816 6.0615 39.9329 6.7282C39.4841 7.39446 39.2166 8.20168 39.129 9.14899H42.1917C42.2645 8.73496 42.3872 8.3759 42.5615 8.0718C42.7354 7.76859 42.9855 7.53498 43.3111 7.3723C43.6367 7.20961 44.0391 7.12805 44.5168 7.12805C45.1542 7.12805 45.6497 7.23532 46.0052 7.45032C46.3594 7.66487 46.5372 7.98713 46.5372 8.41668C46.5372 8.69816 46.4323 8.92734 46.222 9.1051C46.0117 9.28286 45.6935 9.43047 45.2664 9.54927C44.8394 9.66807 44.2922 9.80106 43.6263 9.94912C42.5403 10.1708 41.6419 10.4452 40.9326 10.771C40.2225 11.0968 39.6974 11.5077 39.3575 12.0037C39.0168 12.4998 38.8468 13.1328 38.8468 13.9023C38.8468 14.7025 39.0241 15.3652 39.3792 15.8905C39.7339 16.4167 40.2264 16.8161 40.8563 17.09C41.4863 17.3635 42.2142 17.5005 43.0397 17.5005C43.8357 17.5005 44.5459 17.3453 45.1685 17.0341C45.7629 16.7371 46.2385 16.3253 46.6022 15.8058V17.2341H49.5565V8.70481C49.5565 7.87587 49.3861 7.15775 49.0457 6.55089C48.7054 5.94359 48.1695 5.47016 47.4386 5.12927L47.439 5.12883ZM46.2771 14.0353C46.1466 14.2725 45.9545 14.4724 45.7013 14.6355C45.4477 14.7982 45.1581 14.917 44.832 14.991C44.5064 15.0651 44.1479 15.1023 43.7572 15.1023C43.3666 15.1023 43.0328 15.0465 42.7575 14.9352C42.4822 14.8244 42.2723 14.6657 42.1279 14.4582C41.9827 14.2508 41.9107 14.0061 41.9107 13.725C41.9107 13.3846 41.9792 13.1106 42.1171 12.9032C42.255 12.6957 42.4826 12.5255 42.8017 12.3925C43.1199 12.2591 43.5617 12.111 44.1266 11.9483C44.764 11.7856 45.2634 11.6261 45.6259 11.4705C45.9874 11.3149 46.2697 11.1416 46.4726 10.9483V13.2365C46.4726 13.5326 46.4076 13.7995 46.2775 14.0358L46.2771 14.0353Z"
                    fill="#732EB8"
                  />
                  <path
                    d="M58.3889 4.88428L55.5213 13.8431L52.6538 4.88428H49.4828L53.5448 17.2338H54.848H55.9995H57.2816L61.3656 4.88428H58.3889Z"
                    fill="#732EB8"
                  />
                  <path
                    d="M69.4415 5.33934C68.5943 4.85838 67.5911 4.61768 66.4326 4.61768C65.3609 4.61768 64.3832 4.86946 63.5001 5.37259C62.6165 5.87616 61.9107 6.59074 61.3822 7.51632C60.8528 8.4419 60.5887 9.54834 60.5887 10.8365V11.3915C60.5887 12.5622 60.8315 13.6057 61.3171 14.5238C61.8018 15.4414 62.4934 16.1635 63.3917 16.6892C64.2891 17.215 65.3535 17.4778 66.5848 17.4778C67.5841 17.4778 68.4638 17.3072 69.2243 16.9672C69.9847 16.6263 70.6108 16.1152 71.1033 15.4343C71.5954 14.7534 71.9145 13.8943 72.0593 12.8579H69.0829C68.9668 13.5689 68.6954 14.1053 68.2683 14.4684C67.8413 14.8314 67.2802 15.0127 66.5848 15.0127C65.9614 15.0127 65.4368 14.8647 65.0097 14.5685C64.5822 14.2724 64.2527 13.8615 64.0216 13.3358C63.82 12.8792 63.7116 12.3548 63.6852 11.7701H72.081V10.6371C72.081 9.37856 71.8529 8.30094 71.3968 7.40506C70.9407 6.50962 70.2887 5.8212 69.4415 5.33979V5.33934ZM65.0314 7.42722C65.4441 7.18297 65.9111 7.06107 66.4322 7.06107C67.3301 7.06107 67.9895 7.3164 68.4096 7.82751C68.7214 8.20652 68.9165 8.75087 68.9971 9.46013H63.7823C63.8434 9.13298 63.9284 8.8413 64.0429 8.59395C64.2891 8.06067 64.6186 7.67191 65.0314 7.42766V7.42722Z"
                    fill="#732EB8"
                  />
                  <path
                    d="M79.4367 4.61768C78.8137 4.61768 78.2709 4.71742 77.8074 4.91734C77.3439 5.11726 76.9529 5.38766 76.6346 5.72811C76.3494 6.03264 76.12 6.36511 75.9392 6.7224V4.88365H73.0062V17.2331H76.0905V10.2146C76.0905 9.7558 76.1486 9.34088 76.2644 8.9703C76.3801 8.6006 76.5466 8.28941 76.7643 8.03762C76.9811 7.78628 77.2343 7.59345 77.5243 7.46002C77.8139 7.32659 78.1473 7.2601 78.5241 7.2601C78.9438 7.2601 79.3058 7.35319 79.6101 7.5376C79.914 7.72289 80.1425 7.97867 80.2943 8.30404C80.4465 8.62985 80.5223 9.00753 80.5223 9.43708V17.2331H83.6071V9.03723C83.6071 7.63025 83.2446 6.54198 82.5206 5.77243C81.7965 5.00289 80.7682 4.61768 79.4358 4.61768H79.4367Z"
                    fill="#732EB8"
                  />
                  <path
                    d="M88.4715 0.57959H87.0629L84.8331 7.20715H86.2591L86.7516 5.73145H89.0525L89.5433 7.20715H91.1335L88.9038 0.57959H88.4715ZM87.1765 4.45878L87.9044 2.27826L88.6293 4.45878H87.1765Z"
                    fill="#732EB8"
                  />
                  <path
                    d="M95.1681 3.56621H93.8892V4.9005H95.1651C95.1612 5.05697 95.1352 5.2006 95.0819 5.32915C95.0242 5.46746 94.9423 5.58227 94.8356 5.67403C94.729 5.7649 94.6024 5.83583 94.4554 5.88592C94.3084 5.93601 94.1428 5.96128 93.9581 5.96128C93.6412 5.96128 93.3702 5.89168 93.146 5.75338C92.921 5.61551 92.7511 5.40407 92.6357 5.12169C92.5209 4.83844 92.4632 4.48248 92.4632 4.05249V3.78741C92.4632 3.35121 92.5178 2.98905 92.6275 2.70003C92.7368 2.41189 92.8985 2.19645 93.1114 2.05505C93.3247 1.91364 93.5783 1.84316 93.8722 1.84316C94.0504 1.84316 94.2104 1.86665 94.3518 1.91364C94.4931 1.96063 94.6154 2.03111 94.7194 2.12553C94.823 2.21995 94.9067 2.3352 94.97 2.4704C95.0333 2.60561 95.071 2.76164 95.0823 2.93896H96.6552C96.6379 2.497 96.5516 2.12287 96.396 1.81656C96.2408 1.51025 96.0344 1.25846 95.7782 1.0612C95.5219 0.863937 95.2306 0.720756 94.9054 0.632542C94.5798 0.544329 94.2356 0.5 93.8727 0.5C93.4634 0.5 93.0758 0.569596 92.7103 0.707458C92.3444 0.846206 92.0231 1.05233 91.7465 1.32628C91.4699 1.60023 91.254 1.94467 91.0984 2.36047C90.9431 2.77538 90.8651 3.263 90.8651 3.82287V3.96428C90.8651 4.50641 90.9358 4.98472 91.0767 5.40052C91.218 5.81588 91.4149 6.16519 91.6685 6.44756C91.9221 6.73082 92.226 6.94404 92.5803 7.08855C92.9349 7.23306 93.319 7.30488 93.7339 7.30488C94.1489 7.30488 94.5122 7.23705 94.823 7.10185C95.1213 6.97197 95.3624 6.7654 95.5492 6.48657L95.7734 7.2078H96.6721V3.56621H95.1681Z"
                    fill="#732EB8"
                  />
                  <path
                    d="M99 0.57959H97.4188V7.20715H99V0.57959Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.1"
                    d="M3.25816 0.531738H0V3.86303H3.25816V0.531738Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.25"
                    d="M6.51634 0.531738H3.25818V3.86303H6.51634V0.531738Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.1"
                    d="M9.77489 0.531738H6.51672V3.86303H9.77489V0.531738Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.1"
                    d="M16.2912 0.531738H13.0331V3.86303H16.2912V0.531738Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.75"
                    d="M13.0331 0.531738H9.7749V3.86303H13.0331V0.531738Z"
                    fill="#732EB8"
                  />
                  <path
                    d="M6.51634 3.86279H3.25818V7.19408H6.51634V3.86279Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.1"
                    d="M9.77489 3.86279H6.51672V7.19408H9.77489V3.86279Z"
                    fill="#732EB8"
                  />
                  <path
                    d="M13.0331 3.86279H9.7749V7.19408H13.0331V3.86279Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.25"
                    d="M3.25816 3.86279H0V7.19408H3.25816V3.86279Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.1"
                    d="M16.2912 3.86279H13.0331V7.19408H16.2912V3.86279Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.75"
                    d="M3.25816 7.19482H0V10.5261H3.25816V7.19482Z"
                    fill="#732EB8"
                  />
                  <path
                    d="M6.51634 7.19482H3.25818V10.5261H6.51634V7.19482Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.25"
                    d="M9.77489 7.19482H6.51672V10.5261H9.77489V7.19482Z"
                    fill="#732EB8"
                  />
                  <path
                    d="M16.2912 7.19482H13.0331V10.5261H16.2912V7.19482Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.75"
                    d="M13.0331 7.19482H9.7749V10.5261H13.0331V7.19482Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.75"
                    d="M3.25816 13.8574H0V17.1887H3.25816V13.8574Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.1"
                    d="M6.51634 13.8574H3.25818V17.1887H6.51634V13.8574Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.5"
                    d="M9.77489 13.8574H6.51672V17.1887H9.77489V13.8574Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.25"
                    d="M16.2912 13.8574H13.0331V17.1887H16.2912V13.8574Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.1"
                    d="M13.0331 13.8574H9.7749V17.1887H13.0331V13.8574Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.1"
                    d="M6.51634 10.5259H3.25818V13.8572H6.51634V10.5259Z"
                    fill="#732EB8"
                  />
                  <path
                    d="M9.77489 10.5259H6.51672V13.8572H9.77489V10.5259Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.25"
                    d="M13.0331 10.5259H9.7749V13.8572H13.0331V10.5259Z"
                    fill="#732EB8"
                  />
                  <path
                    d="M3.25816 10.5259H0V13.8572H3.25816V10.5259Z"
                    fill="#732EB8"
                  />
                  <path
                    opacity="0.75"
                    d="M16.2912 10.5259H13.0331V13.8572H16.2912V10.5259Z"
                    fill="#732EB8"
                  />
                </g>
                <defs>
                  <clipPath id="clip0_2920_60608">
                    <rect
                      width="99"
                      height="17"
                      fill="white"
                      transform="translate(0 0.5)"
                    />
                  </clipPath>
                </defs>
              </svg>
            </div>
            <div className="px-3 py-[9px] bg-[#f5ebe2] rounded-[18px] flex items-center">
              <div className="text-[#9b8c7c] text-xs font-bold font-['Control Upright'] leading-[10.80px]">
                {badgeText}
              </div>
            </div>
          </div>
          <Button
            variant="secondary"
            size="base"
            outline={true}
            onClick={handleCopyLink}
            className={cn(
              "px-6 py-1 bg-white rounded-xl border  border-[#dadee3] flex items-center gap-2",
              isCopied && "bg-green-50",
            )}
          >
            <div className="py-[1.50px] flex items-center gap-2">
              <span className="text-[#272c34] text-sm font-normal font-['Control Upright'] leading-[21px]">
                {isCopied ? "Copied!" : "Copy link"}
              </span>
            </div>
            {isCopied ? (
              <CheckIcon className="h-4 w-4 text-green-600" />
            ) : (
              <LinkIcon className="h-4 w-4 text-[#414956]" />
            )}
          </Button>
        </div>
      </div>
    </header>
  );
}
